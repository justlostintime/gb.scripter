' Gambas class file

''' This object is returned when an application receives a Compile error event\
''' or when an application reads from the compile error queue **ScriptCompileErrors**.

Export

Public LineNumber As Integer = 0          '' The line number the error occured on
Public FileName As String = ""            '' The name of the file that the error occured in
Public Position As Integer = 0            '' The position of the line that the error occured
Public Message As String = ""             '' The error message returned by the compiler
Public msgType As String = ""             '' Error type field
Public text As String = ""                '' The original message returned by the compiler

'' New object CompileErrorMsg created
'' Sample input  "MMain.module:7:7: error: Unknown identifier: Prints\n"
Public Sub _new(ErrorAsText As String)

  Verbose("Creating error Mesaage:" & ErrorAsText)
  Dim fields As String[] = Split(ErrorAsText, ":", "\"\"", True)

  If fields.count >= 1 Then Try FileName = fields[0]
  If fields.count >= 2 Then Try LineNumber = fields[1]
  If fields.count >= 3 Then Try Position = fields[2]
  If fields.count >= 4 Then Try msgType = Trim(fields[3])
  If fields.count >= 5 Then
    Try Message = Trim(fields.Extract(4, -1).Join(":"))
  Endif

  text = ErrorAsText

End
